function CrosswordCell(r){this["char"]=r,this.across=null,this.down=null}function CrosswordCellNode(r,e){this.is_start_of_word=r,this.index=e}function WordElement(r,e){this.word=r,this.index=e}function Crossword(r,e){var t,n=50,o=50,l={};this.getSquareGrid=function(r){for(var e=null,t=0,n=0;r>n;n++){var o=this.getGrid(1);if(null!=o){var l=1*Math.min(o.length,o[0].length)/Math.max(o.length,o[0].length);if(l>t&&(e=o,t=l),1==t)break}}return e},this.getGrid=function(r){if(!v[0])return null;for(var e=0;r>e;e++){f();var n=h(),o=Math.floor(g.length/2),l=Math.floor(g[0].length/2),d=v[0];if("across"==n?l-=Math.floor(d.word.length/2):o-=Math.floor(d.word.length/2),u(d.word,o,l,n)===!1)return t=[d],null;s(d.word,d.index,o,l,n);var i=[];i.push(v.slice(1));for(var w=0;w<i.length;w++){word_has_been_added_to_grid=!1;for(var _=0;_<i[w].length;_++){var d=i[w][_],m=c(d.word);if(m){var o=m.row,l=m.col,p=m.direction;s(d.word,d.index,o,l,p),word_has_been_added_to_grid=!0}else i.length-1==w&&i.push([]),i[w+1].push(d)}if(!word_has_been_added_to_grid)break}if(word_has_been_added_to_grid)return a()}return t=i[i.length-1],null},this.getBadWords=function(){return t},this.getLegend=function(t){for(var n={across:[],down:[]},o=1,l=0;l<t.length;l++)for(var a=0;a<t[l].length;a++){var d=t[l][a],s=!1;for(var i in n)if(d&&d[i]&&d[i].is_start_of_word){var u=d[i].index;n[i].push({position:o,index:u,clue:e[u],word:r[u]}),s=!0}s&&o++}return n};for(var a=function(){for(var r=n-1,e=0,t=o-1,l=0,a=0;n>a;a++)for(var d=0;o>d;d++){var s=g[a][d];null!=s&&(r>a&&(r=a),a>e&&(e=a),t>d&&(t=d),d>l&&(l=d))}for(var i=e-r+1,u=l-t+1,h=new Array(i),a=0;i>a;a++)for(var d=0;u>d;d++)h[a]=new Array(u);for(var a=r,c=0;i>c;a++,c++)for(var d=t,f=0;u>f;d++,f++)h[c][f]=g[a][d];return h},d=function(r,e,t,n,o,a){var d=r.charAt(t);null==g[n][o]&&(g[n][o]=new CrosswordCell(d),l[d]||(l[d]=[]),l[d].push({row:n,col:o}));var s=0==t;g[n][o][a]=new CrosswordCellNode(s,e)},s=function(r,e,t,n,o){if("across"==o)for(var l=n,a=0;l<n+r.length;l++,a++)d(r,e,a,t,l,o);else{if("down"!=o)throw"Invalid Direction";for(var s=t,a=0;s<t+r.length;s++,a++)d(r,e,a,s,n,o)}},i=function(r,e,t){return null==g[e][t]?0:g[e][t]["char"]==r?1:!1},u=function(r,e,t,n){if(0>e||e>=g.length||0>t||t>=g[e].length)return!1;if("across"==n){if(t+r.length>g[e].length)return!1;if(t-1>=0&&null!=g[e][t-1])return!1;if(t+r.length<g[e].length&&null!=g[e][t+r.length])return!1;for(var o=e-1,l=t,a=0;o>=0&&l<t+r.length;l++,a++){var d=null==g[o][l],s=null!=g[e][l]&&g[e][l]["char"]==r.charAt(a),u=d||s;if(!u)return!1}for(var o=e+1,l=t,a=0;o<g.length&&l<t+r.length;l++,a++){var d=null==g[o][l],s=null!=g[e][l]&&g[e][l]["char"]==r.charAt(a),u=d||s;if(!u)return!1}for(var h=0,l=t,a=0;l<t+r.length;l++,a++){var c=i(r.charAt(a),e,l);if(c===!1)return!1;h+=c}}else{if("down"!=n)throw"Invalid Direction";if(e+r.length>g.length)return!1;if(e-1>=0&&null!=g[e-1][t])return!1;if(e+r.length<g.length&&null!=g[e+r.length][t])return!1;for(var l=t-1,o=e,a=0;l>=0&&o<e+r.length;o++,a++){var d=null==g[o][l],s=null!=g[o][t]&&g[o][t]["char"]==r.charAt(a),u=d||s;if(!u)return!1}for(var l=t+1,o=e,a=0;o<e+r.length&&l<g[o].length;o++,a++){var d=null==g[o][l],s=null!=g[o][t]&&g[o][t]["char"]==r.charAt(a),u=d||s;if(!u)return!1}for(var h=0,o=e,a=0;o<e+r.length;o++,a++){var c=i(r.charAt(a,1),o,t);if(c===!1)return!1;h+=c}}return h},h=function(){return Math.floor(2*Math.random())?"across":"down"},c=function(r){for(var e=[],t=0;t<r.length;t++){var n=l[r.charAt(t)];if(n)for(var o=0;o<n.length;o++){var a=n[o],d=a.row,s=a.col,i=u(r,d,s-t,"across"),h=u(r,d-t,s,"down");i!==!1&&e.push({intersections:i,row:d,col:s-t,direction:"across"}),h!==!1&&e.push({intersections:h,row:d-t,col:s,direction:"down"})}}if(0==e.length)return!1;var c=e[Math.floor(Math.random()*e.length)];return c},f=function(){for(var r=0;r<g.length;r++)for(var e=0;e<g[r].length;e++)g[r][e]=null;l={}},g=new Array(n),w=0;n>w;w++)g[w]=new Array(o);for(var v=[],w=0;w<r.length;w++)v.push(new WordElement(r[w],w));v.sort(function(r,e){return e.word.length-r.word.length})}function createCrossword(r,e){var t=new Crossword(r,e),n=10,o=t.getSquareGrid(n);if(null==o){for(var l=t.getBadWords(),a=[],d=0;d<l.length;d++)a.push(l[d].word);return document.getElementById("crossword").innerHTML="Add more words - a crossword could not be created with these:"+a.join(","),void(document.getElementById("clues-wrapper").innerHTML='<div id="clues-header"></div><table id="clues"></table>')}var s=!0;document.getElementById("crossword").innerHTML=CrosswordUtils.toHtml(o,s);var i=t.getLegend(o);addLegendToPage(i)}function addLegendToPage(r){document.getElementById("clues-header").innerHTML="<div id='scissors'><div></div></div><h1 class='titles'>Teacher Sheet</h1></br>",document.getElementById("clues").innerHTML='<thead><tr><th>Across</th><th>Down</th></tr></thead><tbody><tr><td><ul id="across"></ul></td><td><ul id="down"></ul></td></tr></tbody>';for(var e in r){for(var t=[],n=0;n<r[e].length;n++)t.push("<li><strong>"+r[e][n].position+".</strong> "+r[e][n].clue+"</li>");document.getElementById(e).innerHTML=t.join("\n")}}function updateCount(){list.children.length>1?count.innerHTML=list.children.length+" words":0==list.children.length?count.innerHTML="hit enter to add word":count.innerHTML=list.children.length+" word"}var CrosswordUtils={PATH_TO_PNGS_OF_NUMBERS:"numbers/",toHtml:function(r,e){if(null!=r){for(var t=[],n=0;2>n;n++){0==n?t.push("<h1 class='titles'>Student A</h1>"):t.push("<div id='scissors'><div></div></div><h1 class='titles'>Student B</h1>"),t.push("<table class='crossword'>");for(var o=1,l=0;l<r.length;l++){t.push("<tr>");for(var a=0;a<r[l].length;a++){var d=r[l][a],s=!1;if(null==d)var i="&nbsp;",u="no-border";else{var i=d["char"],u="";1==n?d.across||(i=""):d.down||(i="");var s=d.across&&d.across.is_start_of_word||d.down&&d.down.is_start_of_word}if(s){var h=CrosswordUtils.PATH_TO_PNGS_OF_NUMBERS+o+".png";t.push("<td class='"+u+"' style=\"background-image:url('"+h+"')\">"),o++}else t.push("<td class='"+u+"'>");e?t.push(i):t.push("&nbsp;")}t.push("</tr>")}t.push("</table></br></br>")}return t.join("\n")}}},newWord=document.getElementById("word-new"),list=document.getElementById("word-list"),count=document.getElementById("word-count"),wordArray=[];list.addEventListener("click",function(r){r.target!==r.currentTarget&&"destroy"==r.target.className&&(wordArray.splice(wordArray.indexOf(r.target.parentElement.getElementsByTagName("LABEL")[0].innerHTML),1),r.target.parentElement.parentNode.removeChild(r.target.parentElement),updateCount(),createCrossword(wordArray,wordArray)),r.stopPropagation()}),newWord.addEventListener("keypress",function(r){if(13==r.keyCode&&""!==newWord.value.trim()){var e=document.createElement("li");e.innerHTML="<label>"+newWord.value+'</label><button class="destroy"></button>',list.insertBefore(e,list.childNodes[0]),wordArray.push(newWord.value),createCrossword(wordArray,wordArray),newWord.value="",updateCount()}});